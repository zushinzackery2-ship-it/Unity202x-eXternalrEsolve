Metadata Module Scan Algorithm

1. Purpose
    Scan a target module memory to locate the pointer to IL2CPP global-metadata
    and validate it via header scoring.

2. Inputs
- moduleBase: target module base
- moduleSize/sizeOfImage: scan limit
- sections: obtained from PE parser
- chunkSize: read block size (default 0x200000)
- maxPages: max distinct pages tracked before validation (default 8192)
- maxSeconds: time budget (default 15.0)
- requiredVersion: 0 for score mode, non-zero to enforce exact version

3. High-level flow
a. Select scan sections
   - Use PE sections and keep only: .data/.rdata/.pdata/.tls/.reloc
   - Clamp each section size to sizeOfImage
   - If PE parse fails: fallback to a conservative pseudo section

b. Chunk scan
   For each selected section:
   - Read in chunks (chunkSize)
   - Iterate each 8-byte aligned offset in the chunk
   - Treat value as candidate pointer (u64) and apply fast filters:
     - non-zero
     - canonical user-mode range (0x10000 .. 0x00007FFFFFFFFFFF)
     - 4-byte aligned

c. Page grouping
   For each candidate pointer ptr:
   - page = ptr & ~0xFFF
   - store (ptrAddrInModule, ptrValue) under pageMap[page]

d. Validate pages
   For each page in pageMap:
   - Read 0x1000 bytes from remote at page into pageBuf
   - For each candidate ptr in that page:
     - delta = ptr - page
     - ScoreMetadataHeader(pageBuf, delta, requiredVersion)
     - Keep best score as FoundMeta{metaBase=ptr, ptrAddr, maxEnd}
   - Early-exit: if best metaBase tail byte is readable at metaBase+maxEnd-1

e. Result
   - Return best FoundMeta (metaBase==0 means not found)

4. Implementation location
- External/Metadata/MetadataScanner.hpp
