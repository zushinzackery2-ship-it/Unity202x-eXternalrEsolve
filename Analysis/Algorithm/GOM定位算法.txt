GOM定位算法

0. 目标
    - 在远程进程的 UnityPlayer.dll 中定位 gomGlobal 指针槽地址（slot），并得到 offset(RVA)
    - slot 的语义：manager = *(gomGlobal) -> GameObjectManager*

1. 输入 / 输出
    1.1 输入
        - mem: 远程内存访问器（IMemoryAccessor）
        - pid: 目标进程 PID（通过 SetTargetPid 配置）

    1.2 输出
        - found.gomGlobal: 指针槽地址（slot 地址，位于 UnityPlayer.dll 的 .data/.rdata）
        - found.manager: *(found.gomGlobal) 的值（候选 GameObjectManager*）
        - found.score: 验证得分（用于在多个候选中选最好）
        - offset(RVA) = found.gomGlobal - moduleBase

2. 扫描范围构造（仅 Win64，按 8 字节槽扫描）
    2.1 优先路径：读取远程 PE 节区
        - ReadModuleSections(mem, moduleBase, sizeOfImage, sections)
        - 仅保留节区名为 .data / .rdata
        - 对每个节区做范围收敛：
            - rva < sizeOfImage
            - size = min(size, sizeOfImage - rva)

3. 候选槽提取（指针槽采样）
    - 对每个扫描节区：
        - 从 secStart = moduleBase + sec.rva 开始，按 chunkSize 分块读取
        - 对每个 chunk 内存：
            - 以 8 字节步进读取 ptr
            - 基本过滤（Win64-only）：
                - ptr != 0
                - ptr 在合理地址范围内
                - ptr 8 字节对齐（(ptr & 7) == 0）
            - 将该 ptr 作为 manager 候选，进入验证

4. 候选验证（ManagerCandidateCheck，快速排假）
    4.1 读 manager 关键字段
        - buckets = *(manager + 0x00)
        - bucketCount = *(manager + 0x08) (int32)
        - 约束：
            - buckets != 0
            - bucketCount > 0 且 bucketCount <= 0x100000

    4.2 验证“本地对象列表”环形双链表特征
        - allManagersList = *(manager + 0x28)
        - 验证该地址为环形双链表（pLast/pNext 互相一致）
        - 要求 listSteps > 0（空链表判为失败）

    4.3 验证 buckets：前 1000 个 bucket 至少命中 1 个合法
        - bucketStride = 0x18
        - 遍历 idx = 0..min(bucketCount, 1000)-1
        - 对每个 bucketPtr = buckets + idx*0x18：
            - 读取 mask/key 并检查一致性：
                - expectedMask = CalHashmaskThrougTag((int32)(key32))
                - mask 必须 == expectedMask
            - 读取 listHead = *(bucket + 0x10)
            - 判定桶非空：
                - first = *(listHead + 0x08)
                - first != listHead
        - 若合法 bucket 数为 0，则判为失败；多个合法 bucket 增加得分

    4.4 得分策略（用于多候选选优）
        - score 由多个通过项累加
        - listSteps 越大得分越高（上限截断）

5. 结果选择与返回
    - 维护 best 结果：r.score 最大者胜出
    - best.gomGlobal = 当前 ptr 所在的指针槽地址（chunkAddr + off）
    - best.manager = ptr

6. 一键定位（跨进程）
    - FindGOMGlobalByScan()
        - 依赖：已通过 SetGlobalMemoryAccessor(...) 设置访问器
        - 依赖：已通过 SetTargetPid(pid) 设置目标 PID
        - 内部：FindModuleBase(pid, "UnityPlayer.dll") 得到 moduleBase
        - 调用内部扫描并返回 offset(RVA)

7. 输出格式约定
    - gomScanner 输出：UnityPlayer.dll+0x????????
    - 该值表示 gomGlobal 指针槽的 RVA（不是 manager 的 RVA）
